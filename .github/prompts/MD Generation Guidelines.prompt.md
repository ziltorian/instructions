---
name: Markdown to JSON Specification
description: Specification for a Markdown format designed for automatic conversion to structured JSON.
agent: agent
---

## Спецификация формата Markdown для генерации JSON

Инструкция по формированию структурированного текста:
- Цель: Этот формат нужен для дальнейшего автоматического преобразования в структурированный JSON с помощью конвертора.
- Структура текста должна строго соблюдаться — заголовки, ключи, списки и абзацы распознаются по форме.
- Формат:
  1. Заголовки (#–##########) → Создают вложенные блоки-словари до 10 уровней.
  2. Пары [ключ:значение] → `{"Имя": "Значение"}`
  3. Пустые ключи [Ключ:]
  → Создают контейнер для следующих данных до:
    - Пустой строки
    - Следующего ключа того же уровня
    - Заголовка
  4. Списки: строки начинающиеся с [- – —]
  → перед которыми есть ключ, добавляются под этим ключем как массив.
  → Иначе: в `_list` текущего блока.
  5. Текст: всё, что не подходит под другие правила
  → Если есть активный ключ: в его `_text` как единая строка с `\n`
  → Иначе: в `_text` текущего блока
  → Несколько строк объединяются: `"Просто текст\nВторая строка"`
  6. Разделитель ---: разделяет блоки, если заголовки не используются
  7. Отступы (4 пробела или 1 таб) → задают вложенность
    ``` markdown
    Родитель:
        Ребёнок: значение
        Внук:
            - элемент
    ```
    →
    ``` json
    {
      "Родитель": {
        "Ребёнок": "значение",
        "Внук": ["элемент"]
      }
    }
    ```
  8. Специальные маркеры: `- $:` → элемент списка-объекта (словаря); `- _` → явный маркер завершения списка
    ```markdown
    Персонажи:
    - $:
        имя: Алекс
        раса: Человек
    - $:
        имя: Борис
        раса: Эльф
    ```
    →
    ```json
    {
      "Персонажи": [
        {"имя": "Алекс", "раса": "Человек"},
        {"имя": "Борис", "раса": "Эльф"}
      ]
    }
    ```

### Пример:

``` Markdown
# Документ                              <- Название файла и ключ оборачивающий весь контент
## Пример ключа без значения            <- Ключ вложенного блока, второго уровня
Ключ:                                   <- пустой ключ
## Пример пары ключ_значение            <- Ключ вложенного блока, второго уровня
Имя: Образец                            <- пара ключ_значение
## Заголовок в качестве ключа списка    <- Ключ вложенного блока, второго уровня, если нет других элементов превращается в ключ списка
- Элемент списка 1                      <- элемент списка
- Элемент списка 2                      <- элемент списка
## Пример обычного текста               <- Ключ вложенного блока, второго уровня, если нет других элементов превращается в ключ текста
Это абзац описания.                     <- строка текста сохраняется как элемент списка
Он продолжается со следующей строки.    <- строка текста сохраняется как элемент списка
## Пример списка, привязанного к ключу  <- Ключ вложенного блока, второго уровня
Навыки:                                 <- ключ списка
- Атлетика                              <- элемент списка
- Выживание                             <- элемент списка
---                                     <- разделитель блоков
# Документ 2                            <- Название второго файла и/или ключ оборачивающий весь контент до следующего разделителя
Текст второго документа.                <- строка текста перед которым нет ключа, попадает в специальный ключ "_text:"
Второй абзац второго документа.         <- строка текста перед которым нет ключа, попадает в специальный ключ "_text:"
- Список второго документа.             <- элемент списка перед которым нет ключа, попадает в специальный ключ "_list:"
- Еще один элемент списка.              <- элемент списка перед которым нет ключа, попадает в специальный ключ "_list:"
Пустой Ключ:                            <- пустой ключ
Ключ2: Значение2                        <- пара ключ_значение
- Элемент списка без пустого ключа      <- элемент списка перед которым нет ключа, попадет в специальный ключ "_list:" текущего блока
Ключ списка:                            <- ключ списков
- Элемент списка 1                      <- элемент списка
- Элемент списка 2                      <- элемент списка
```

### Результат:

``` JSON
{
  "Документ": {
    "id": "73779be5",                  <-- пример автоматически сгенерированного ID>
    "Пример ключа без значения": {
      "Ключ": {}
    },
    "Пример пары ключ_значение": {
      "Имя": "Образец"
    },
    "Заголовок в качестве ключа списка": [
      "Элемент списка 1",
      "Элемент списка 2"
    ],
    "Пример обычного текста": "Это абзац описания.\nОн продолжается со следующей строки.",
    "Пример списка, привязанного к ключу": {
      "Навыки": [
        "Атлетика",
        "Выживание"
      ]
    },
    "Документ 2": {                     <-- второй документ помещен в тот же JSON на уровне 2 т.к. не выбран параметр разделения по файлам>
      "_text": "Текст второго документа.\nВторой абзац второго документа.",
      "_list": [
        "Список второго документа.",
        "Еще один элемент списка.",
        "Элемент списка без пустого ключа"  <- элементы списка без ключа помещены в специальный ключ _list нарушив порядок данных элементов>
      ],
      "Пустой Ключ": {},
      "Ключ2": "Значение2",
      "Ключ списка": [
        "Элемент списка 1",
        "Элемент списка 2"
      ]
    }
  }
}
```
