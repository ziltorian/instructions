# Основы Prompt Engineering

## Ключевые принципы создания промптов

### 1. Ясность и конкретность

- Формулируйте инструкции четко и однозначно
- Избегайте двусмысленности в формулировках
- Используйте конкретные примеры вместо абстрактных описаний
- Определяйте точные критерии успеха для задачи

**Плохо:** "Сделай что-нибудь с этим текстом"
**Хорошо:** "Проанализируй этот текст и извлеки все упоминания дат, имен и организаций. Представь результат в формате JSON"

### 2. Структура промпта

Рекомендуемая структура:

```
# Роль и цель
Определите роль AI и основную задачу

# Контекст
Предоставьте необходимую справочную информацию

# Инструкции
Пошаговые указания для выполнения задачи

# Формат вывода
Точное описание желаемого формата результата

# Примеры
Конкретные примеры входных данных и ожидаемого результата

# Ограничения
Что НЕ следует делать, границы задачи
```

### 3. Использование делимитеров

Эффективные типы разделителей:

**Markdown** (рекомендуется для начала):

- Заголовки: #, ##, ###
- Код: `inline` или ```блоки```
- Списки: упорядоченные и неупорядоченные

**XML теги** (отлично для сложных структур):

```xml
<context>
  <background>...</background>
  <requirements>...</requirements>
</context>

<examples>
  <example id="1">
    <input>...</input>
    <output>...</output>
  </example>
</examples>
```

**JSON** (для структурированных данных):

- Хорошо понимается в контексте кода
- Требует экранирования символов
- Может быть многословным

### 4. Техники улучшения качества

#### Chain of Thought (CoT)

Побуждайте модель думать пошагово:

```
Решите эту задачу пошагово:
1. Сначала проанализируйте исходные данные
2. Определите ключевые паттерны
3. Сформулируйте гипотезу
4. Проверьте гипотезу на примерах
5. Сформулируйте окончательный ответ
```

#### Few-Shot Learning

Предоставьте 2-5 примеров желаемого поведения:

```
<examples>
Пример 1:
Вход: "Куплю iPhone 13"
Выход: {"intent": "purchase", "product": "iPhone 13", "sentiment": "neutral"}

Пример 2:
Вход: "Этот телефон ужасен!"
Выход: {"intent": "complaint", "product": "unknown", "sentiment": "negative"}
</examples>

Теперь обработайте: "Ищу хороший смартфон до 500$"
```

#### Self-Consistency

Для критически важных задач:

```
Решите эту задачу тремя разными способами.
Затем сравните результаты и выберите наиболее обоснованный ответ.
```

### 5. Управление длинным контекстом

Для больших объемов данных:

- Размещайте инструкции в начале И в конце контекста
- Используйте структурированные форматы (XML, таблицы)
- Явно указывайте на важные части контекста
- Используйте промежуточные итоги для длинных документов

### 6. Определение роли (System Prompts)

Эффективные системные промпты включают:

```
Ты — [конкретная роль] с [специфическими навыками].

Твоя задача: [четкое описание главной цели]

Характеристики твоей работы:
- [ключевая черта 1]
- [ключевая черта 2]
- [ключевая черта 3]

Ты должен всегда:
- [обязательное поведение 1]
- [обязательное поведение 2]

Ты никогда не должен:
- [запрещенное поведение 1]
- [запрещенное поведение 2]
```

### 7. Форматирование выхода

**Для структурированных данных:**

```
Верни результат ТОЛЬКО в формате JSON без дополнительного текста:
{
  "field1": "value",
  "field2": ["item1", "item2"]
}
```

**Для текстовых ответов:**

```
Структура ответа:
1. Краткое резюме (2-3 предложения)
2. Детальный анализ (3-5 параграфов)
3. Рекомендации (маркированный список)
4. Заключение (1 параграф)
```

### 8. Итеративная разработка

Процесс оптимизации промпта:

1. Начните с базовой версии
2. Протестируйте на разнообразных примерах
3. Выявите паттерны ошибок
4. Уточните инструкции для проблемных случаев
5. Добавьте примеры для граничных случаев
6. Повторите процесс

### 9. Специфические техники

#### Префиллинг (для Claude)

Начните ответ модели нужным образом:

```
User: Напиши короткую историю
Assistant: Конечно! Вот история:

Название:
```

#### Zero-Shot vs Few-Shot

- **Zero-Shot**: Для простых, понятных задач
- **Few-Shot**: Для сложных паттернов или специфического формата

#### Температура и параметры

- **Творческие задачи**: temperature 0.7-1.0
- **Аналитические задачи**: temperature 0.0-0.3
- **Код**: temperature 0.0-0.2

### 10. Антипаттерны (чего избегать)

❌ Слишком общие инструкции
❌ Противоречивые требования
❌ Примеры, не соответствующие инструкциям
❌ Избыточное использование КАПСА или эмодзи
❌ Предположения о знаниях модели
❌ Нечеткие критерии успеха

### 11. Проверка качества промпта

Хороший промпт должен:

- ✅ Быть понятным человеку без контекста
- ✅ Давать консистентные результаты
- ✅ Содержать измеримые критерии успеха
- ✅ Включать примеры для сложных случаев
- ✅ Явно определять формат вывода
- ✅ Учитывать граничные случаи

### 12. Тестирование промптов

Создайте набор тестовых случаев:

- Типичные примеры (70%)
- Граничные случаи (20%)
- Потенциально проблемные входы (10%)

Метрики оценки:

- Точность ответов
- Консистентность формата
- Время выполнения
- Стоимость (токены)
